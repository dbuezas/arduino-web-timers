{"version":3,"sources":["data/timers.ts","Plot/margin.ts","Plot/XAxis.tsx","Plot/YAxis.tsx","helpers/simulator.ts","Plot/CompareRegisterHandle.tsx","Plot/InterruptArrow.tsx","Plot/Curve.tsx","helpers/compareRegisterUtil.ts","state/useHash.ts","data/lgt328p/index.ts","data/atmega328p/index.ts","helpers/types.ts","data/index.ts","state/state.tsx","helpers/helpers.ts","Panes/state.ts","Plot/Plot.tsx","Panes/Code.tsx","Panes/TimerSetup.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["tsv","str","trim","split","map","line","join","registers","constraints","tsvRegisters","configs","tsvConstraints","table","filter","startsWith","header","row","Object","fromEntries","colName","i","replace","values","includes","rows","register","column","variableDescriptions","Timer","timerMode","topValue","clockPrescalerOrSource","clockDoubler","ExternalClockInput","FCPU_UI","CompareOutputModeA","interruptA","OCnA_OutputPort","OCnA_OutputCurrent","CompareOutputModeB","interruptB","OCnB_OutputPort","OCnB_OutputCurrent","CompareOutputModeC","interruptC","OCnC_OutputPort","OCnC_OutputCurrent","Extras","updateOcrMoment","setTovMoment","InterruptOnTimerOverflow","InputCaptureNoiseSupression","InterruptOnInputCapture","InputCaptureEdgeSelect","DeadTime","valueDescriptions","Normal","PCPWM","CTC","FPWM","PFCPWM","ICR1","ICR3","B1","B3","C0","D3","D6","E4","F1","F5","F6","F7","F2","F4","B2","F3","D5","TOP","BOTTOM","immediate","title","on","margin","toFixed","float","digits","padding","Math","pow","round","formatTime","s","Number","isFinite","m","h","ms","us","ns","formatFreq","hz","khz","mhz","XAxis","height","xScale","nodeRef","useRef","gEl","current","useLayoutEffect","xTicks","ticks","domain","select","call","g","attr","axisBottom","tickValues","tickPadding","tickSize","tickFormat","t","tickSizeOuter","className","ref","YAxis","width","yScale","yTicks","axisLeft","v","_d","_","path","offsetCounter","counter","offset","top","cpuToTcnt","tcnt","dir","tcntToCpu","getTimerLength","cpu","matches","a","b","constrain","n","min","max","CompareRegisterHandle","forwardRef","setCompareRegisterValue","compareRegisterValue","yExtent","name","useState","draggingTV","setDraggingTV","useImperativeHandle","onMouseUp","onMouseMove","y","e","preventDefault","scaled","invert","scaledY","onMouseDown","useCallback","x1","x2","y1","y2","onTouchStart","fill","x","dy","dx","displayName","InterruptArrow","label","flagValues","TCNT","transform","d","Curve","data","idx","curve","curveLinear","datum","theLine","undefined","getName","genericName","OutputA","timerNr","OutputB","OutputC","Input","DeadTimeA","DeadTimeB","getIsTop","getIsInterrupt","getIsActiveOutput","getIsUsed","getIsActiveDeadTime","getIsInput","getIsOutput","getIsDeadTime","compareRegs","getCompareRegTraits","value","parseFloat","code","isInput","isOutput","isDeadTime","isActiveOutput","isTop","isInterrupt","isUsed","getAllCompareRegTraits","sleep","Promise","r","setTimeout","lock","setHashFromObject","debounce","record","cleanRecord","entries","newHash","URLSearchParams","toString","window","location","pathname","leading","trailing","maxWait","getHashParams","hash","slice","timers","forEach","push","PanelModes","MicroControllers","LGT8F328P","lgt328p","ATMEGA328P","atmega328p","panelModeState","atom","key","default","defaultState","mcu","timer","RegisterHashUpdater","useSetRecoilState","userConfigStateBulk","set","state","setState","useEffect","handleHashChange","addEventListener","removeEventListener","useHashChangedExternally","RegisterHashWatcher","obj","useRecoilValue","RegisterHashLink","userConfigState_vars","dangerouslyAllowMutability","userConfigState_store","atomFamily","variable","userConfigState","selectorFamily","get","DefaultValue","vars_old","vars_new","without","uniq","length","selector","console","warn","variables","keys","mcuTimers","micro","timerState","splitTables","left","tables","changed","cluster","remaining","colsLeft","colsRight","intersection","isTruthy","getFullDomains","domains","getConstrainedDomains","domains_","done","every","negated","some","negatedVals","remove","val","positiveVals","miniDomain","flatMap","sizeBefore","groupsState","groupState","groupIdx","suggestedGroupAssignmentState","userState","groupConfigState","group","constrainedGroupDomainsState","instantiations","mapValues","suggestedVariableAssignmentState","groupIdxFromVariableState","suggestedAssignmentState","assignments","flat","assign","relevantVariables","getVariables","userConfig","userValue","findIndex","hasOwnProperty","fullGroupDomainsState","constrainedDomainState","fullDomainState","variableOptionsState","fullDomains","constrainedDomain","selectedWithout","defaultValue","forcedOption","suggestedOption","selectedOption","options","isSuggested","isDisabled","Freq","freq","mode","setMode","Tag","onClick","Plot","style","counterMax","parseInt","param","prescaler","NaN","FCPU","cpuHz","tovTime","OCRnXs","OCRnXs_behaviour","ICRn","deadTimeEnable","deadTimeA","deadTimeB","IOCR_states","traits","find","ocrMax","prev","usePrevious","ioCount","nth","iocr","setReg","isNaN","simulation","prescaledCPUEnd","results","OCnXs","MATCH_Xs","OVF","CAPT","deadTimes","actions","behaviour","action","at","matchAt","to","actionDeadTimeA","actionDeadTimeB","bClear","bSet","tcntEventTimes","prescaledCPU","nextEvents","distToNext","simTimer","containerRef","useSize","height_","activeOCnXs","height_timer","scaleLinear","extent","range","rangeRound","containerEl","handleMouseUp","handleMouseMove","offsetY","MouseEvent","clientY","targetTouches","getBoundingClientRect","document","passive","k","curveStepAfter","j","setUserConfigValue","yExtent2","sqrt","LinkToThisPage","href","url","setUrl","handleUrlChange","Code","codeContainerRef","CopyToClipboard","CompareRegsCode","Interrupts","TimerConfgCode","regName","assignmentsStr","suggestedConfig","interruptCommonSignature","React","memo","clicked","setClicked","Button","color","copy","textContent","log","VariableConfig","humanName","descr","descrTitle","CheckboxGroup","inline","onChange","Whisper","placement","trigger","speaker","Tooltip","Icon","icon","fontSize","valueDescription","Checkbox","indeterminate","disabled","getAllVariablesInGroups","groups","getPanesGroupedByDescription","allVariablesInGroups","variableDescription","panelName","namedVariables","getHiddenPane","allVariables","visibleVariables","difference","TimerSetup","panels","Internal","ByDependencies","getPanesByGroup","FlexboxGrid","flexGrow","overflow","Item","Panel","bordered","shaded","defaultExpanded","direction","bottom","borderTop","touchAction","minHeight","gh","App","timerIdx","setInBulk","useRecoilState","panelMode","setPanelMode","isLoading","rel","Container","Header","Navbar","appearance","src","alt","marginTop","textAlign","Body","Nav","Dropdown","aChip","onSelect","eventKey","activeKey","pullRight","target","frameBorder","scrolling","Content","background","position","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.daac1f92.chunk.js","sourcesContent":["export const tsv = (str: string) => {\n  str = str\n    .trim()\n    .split('\\n')\n    .map((line) => line.trim())\n    .join('\\n')\n  const [registers, ...constraints] = str.trim().split('\\n\\n')\n  return {\n    registers: tsvRegisters(registers),\n    configs: constraints.map(tsvConstraints)\n  }\n}\nexport const tsvConstraints = (str: string) => {\n  const table = str\n    .trim()\n    .split('\\n')\n    .filter((line) => !line.startsWith('//'))\n    .map((line) => line.trim().split('\\t'))\n  const [header, ...rows] = table\n  return rows\n    .map((row) =>\n      Object.fromEntries(\n        header.map((colName, i) => [\n          colName,\n          row[i].trim().replace(/\\\\n/g, '\\n').replace(/\\\\t/g, '\\t')\n        ])\n      )\n    )\n    .filter((row) => !Object.values(row).includes('-'))\n}\n\nexport const tsvRegisters = (str: string) => {\n  const table = str\n    .trim()\n    .split('\\n')\n    .filter((line) => !line.startsWith('//'))\n    .map((line) => line.trim().split('\\t'))\n  const [header, ...rows] = table\n  return Object.fromEntries(\n    header.map((register, column) => [register, rows.map((row) => row[column])])\n  )\n}\n\nexport const variableDescriptions: Record<string, Record<string, string>> = {\n  Timer: {\n    timerMode: 'Timer mode',\n    topValue: 'Top value of timer',\n    clockPrescalerOrSource: 'Clock prescaler or external source',\n    clockDoubler: 'Double timer clock speed',\n    ExternalClockInput: 'External clock input port',\n    FCPU_UI: 'CPU Clock'\n  },\n  'Output A': {\n    CompareOutputModeA: 'Behaviour',\n    interruptA: 'Interrupt on match',\n    OCnA_OutputPort: 'Output port',\n    OCnA_OutputCurrent: 'Output current'\n  },\n  'Output B': {\n    CompareOutputModeB: 'Behaviour',\n    interruptB: 'Interrupt on match',\n    OCnB_OutputPort: 'Output port',\n    OCnB_OutputCurrent: 'Output current'\n  },\n  'Output C': {\n    CompareOutputModeC: 'Behaviour',\n    interruptC: 'Interrupt on match',\n    OCnC_OutputPort: 'Output port',\n    OCnC_OutputCurrent: 'Output current'\n  },\n  Extras: {\n    updateOcrMoment: 'When are the OCRs updated',\n    setTovMoment: 'When overflow interrupt is triggered',\n    InterruptOnTimerOverflow: 'Interrupt on Timer Overflow',\n    InputCaptureNoiseSupression: 'Input capture noise supression',\n    InterruptOnInputCapture: 'Interrupt on Input Capture',\n    InputCaptureEdgeSelect: 'Input Capture Edge Select',\n    DeadTime: 'Insert dead time'\n  }\n}\nexport const valueDescriptions: Record<string, Record<string, string>> = {\n  timerMode: {\n    Normal: 'Counts always up, overflowing to zero. Duty is always 50%.',\n    PCPWM:\n      'Phase correct PWM: Counts up to TOP then down to 0. Output compare registers updated at TOP, maintaining the phase of the PWM. Output is set in one direction and cleared on the other one. Duty goes from full 0% to full 100% but maximum frequency is half that of FPWM.',\n    CTC: 'Clear timer on compare: Counts up to TOP and resets to zero. Duty is always 50%.',\n    FPWM: 'Fast PWM: Counts up to TOP and resets to zero. Duty cycle cannot go to 0% (on clear-on-compare-match), or to 100% (on set-on-compare-match).',\n    PFCPWM:\n      'Phase frequency correct PWM: idem to PCPWM, but output compare registers are updated at zero, resulting in a constant frequency even when the output compare registers are changed during operation.'\n  },\n  topValue: {\n    ICR1: 'If ICR1 is not used as top, the input capture pin (ICP1) is PB0.\\nIf ICR1 is used as top, ICP1 is disconnected. The input compare register is not double-buffered so it will be updated immediatly (and not on TOP or BOTTOM like OCRs). This may make the timer lose a match if changed near it.',\n    ICR3: 'If ICR3 is not used as top, the input capture pin (ICP3) is PF4.\\nIf ICR3 is used as top, ICP3 is disconnected. The input compare register is not double-buffered so it will be updated immediatly (and not on TOP or BOTTOM like OCRs). This may make the timer lose a match if changed near it.'\n  },\n  OCnA_OutputPort: {\n    'E4+C0': 'Both at the same time',\n    'AC0P(D6)':\n      'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t15 \\nQFP32:\tD6\t10 \\nSSOP20:\tD6\t9',\n    B1: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t19 \\nQFP32:\tD9\t13 \\nSSOP20:\tD9\t11',\n    B3: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t23 \\nQFP32:\tD11\t15 \\nSSOP20:\tD11\t12',\n    C0: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t35 \\nQFP32:\tA0\t25 \\nSSOP20:\tA0\t17',\n    D3: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t1 \\nQFP32:\tD3\t1 \\nSSOP20:\tD3\t3',\n    D6: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t14 \\nQFP32:\tD6\t10 \\nSSOP20:\tD6\t9',\n    E4: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t3 \\nQFP32:\t-\t3 \\nSSOP20:\t-\t-',\n    F1: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t46 \\nQFP32:\tD1\t31 \\nSSOP20:\tD1\t1',\n    F5: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t9 \\nQFP32:\t-\t6 \\nSSOP20:\tD?\t6',\n    F6: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t10 \\nQFP32:\t-\t- \\nSSOP20:\t-\t-',\n    F7: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t17 \\nQFP32:\t-\t- \\nSSOP20:\tD7\t10'\n  },\n  OCnB_OutputPort: {\n    F2: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t48 \\nQFP32:\tD2\t32 \\nSSOP20:\tD2\t2',\n    F7: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t17 \\nQFP32:\t-\t- \\nSSOP20:\tD7\t10',\n    D3: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t1 \\nQFP32:\tD3\t1 \\nSSOP20:\tD3\t3',\n    F4: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t5 \\nQFP32:\t-\t5 \\nSSOP20:\tD3\t3',\n    B2: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t20 \\nQFP32:\tD10\t14 \\nSSOP20:\tD10\t12',\n    F3: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t4 \\nQFP32:\t-\t- \\nSSOP20:\t-\t-',\n    D5: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t13 \\nQFP32:\tD5\t9 \\nSSOP20:\tD5\t8'\n  },\n  OCnC_OutputPort: {\n    F3: 'Package\tSilk\tIC\\n───────\t────\t──\\nQFP48:\tD?\t4 \\nQFP32:\t-\t- \\nSSOP20:\t-\t-'\n  },\n  updateOcrMoment: {\n    TOP: 'OCR registers are updated whenever the timer reaches its top. Can be a fixed number or the value of some register',\n    BOTTOM: 'OCR registers are updated when the timer resets to zero',\n    immediate:\n      'OCR registers are updated as soon as they are changed, without a buffer.'\n  },\n  InterruptOnInputCapture: {\n    title: `When ICRn not used as TOP and a capture is triggered (PB0 in Timer1, PF4 in Timer3), the counter value is copied into the input capture register (ICRn). The event will also set the input capture flag (ICFn), and this can be used to cause an input capture interrupt, if this interrupt is enabled. \\nIt can also be used to trigger an interrupt on compare match against the counter.`\n  },\n  InputCaptureNoiseSupression: {\n    on: `The noise canceler improves noise immunity by using a simple digital filtering scheme. The noise canceler input is monitored over four samples, and all four must be equal for changing the output that in turn is used by the edge detector.\n    When enabled, the noise canceler introduces additional four system clock cycles of delay from a change applied\n    to the input, to the update of the ICRn register. The noise canceler uses the system clock and is therefore not affected by the\n    prescaler.`\n  },\n  InputCaptureEdgeSelect: {\n    title: `When the ICRn is used as TOP value, the ICPn is disconnected and consequently the input capture function is disabled.`\n  },\n  DeadTime: {\n    on: `dead time enable control\n    Setting DTENn to logic one, inserting dead time is enable. Base on waveform generated in B channel compare output, both OCnA and OCnB can insert dead time, whose interval is decided by corresponding counter time of DTRn register. Waveform polarity output by OCnA is decided by relationship between CnMn and COMnB, for details referring to list for waveform polarity after inserting dead time.`\n  }\n}\n","export const margin = { top: 30, right: 120, bottom: 30, left: 50 }\n","import { ScaleLinear, ticks, select, axisBottom } from 'd3'\nimport { useRef, useLayoutEffect } from 'react'\nimport { margin } from './margin'\n\ntype ohNoItIsAny = any\n\nconst toFixed = (float: number, digits = 0) => {\n  const padding = Math.pow(10, digits)\n  return Math.round(float * padding) / padding\n}\n\nexport function formatTime(s: ohNoItIsAny) {\n  s = Number(s)\n  if (!Number.isFinite(s)) return '--'\n  if (s === 0) return '0'\n\n  const m = s / 60\n  const h = s / 60 / 60\n  const ms = s * 1000\n  const us = ms * 1000\n  const ns = us * 1000\n  if (ns < 10) return toFixed(ns, 1) + 'ns'\n  if (ns < 1000) return toFixed(ns) + 'ns'\n  if (us < 10) return toFixed(us, 1) + 'μs'\n  if (us < 1000) return toFixed(us) + 'μs'\n  if (ms < 10) return toFixed(ms, 1) + 'ms'\n  if (ms < 1000) return toFixed(ms) + 'ms'\n  if (s < 10) return toFixed(s, 1) + 's'\n  if (h > 1) return toFixed(h, 0) + 'h' + toFixed(m % 60, 1) + 'm'\n  if (m > 5) return toFixed(m, 0) + 'm' + toFixed(s % 60, 1) + 's'\n  return toFixed(s, 0) + 's'\n}\nexport function formatFreq(hz: ohNoItIsAny) {\n  hz = Number(hz)\n  if (!Number.isFinite(hz)) return '--'\n  if (hz === 0) return '0'\n\n  const khz = hz / 1000\n  const mhz = khz / 1000\n  if (hz < 10) return toFixed(hz, 3) + 'Hz'\n  if (hz < 100) return toFixed(hz, 3) + 'Hz'\n  if (hz < 1000) return toFixed(hz, 1) + 'Hz'\n  if (khz < 100) return toFixed(khz, 2) + 'kHz'\n  if (khz < 1000) return toFixed(khz, 1) + 'kHz'\n  if (mhz < 100) return toFixed(mhz, 2) + 'MHz'\n  return toFixed(mhz, 1) + 'MHz'\n}\n\ntype Props = {\n  height: number\n  xScale: ScaleLinear<number, number>\n}\nexport default function XAxis({ height, xScale }: Props) {\n  const nodeRef = useRef<SVGSVGElement>(null)\n  const gEl = nodeRef.current\n  useLayoutEffect(() => {\n    if (!gEl) return\n    const xTicks = ticks(xScale.domain()[0], xScale.domain()[1], 10)\n\n    select(gEl).call((g) => {\n      g.attr('transform', `translate(0,${height - margin.bottom})`)\n        // .transition()\n        // .ease(easeLinear)\n        // .duration(100)\n        .call(\n          axisBottom(xScale)\n            .tickValues(xTicks)\n            .tickPadding(10)\n            .tickSize(-height + margin.top + margin.bottom)\n            .tickFormat((t) => formatTime(t as any))\n            .tickSizeOuter(0)\n        )\n\n      //   .call((g) => g.select('.domain').remove())\n      // g.call((g) => g.select('.domain').remove())\n\n      // return the selection:\n    })\n  }, [gEl, xScale, height])\n\n  return <g className=\"x axis\" ref={nodeRef} />\n}\n","import { ScaleLinear, ticks, select, axisLeft } from 'd3'\nimport { useRef, useLayoutEffect } from 'react'\n\nimport { margin } from './margin'\n\ntype Props = {\n  width: number\n  yScale: ScaleLinear<number, number>\n}\nexport default function YAxis({ width, yScale }: Props) {\n  const nodeRef = useRef<SVGSVGElement>(null)\n  const gEl = nodeRef.current\n\n  useLayoutEffect(() => {\n    if (!gEl) return\n    const yTicks = ticks(yScale.domain()[0], yScale.domain()[1], 10)\n    select(gEl)\n      // .transition()\n      // .duration(200)\n      .call((g) =>\n        g.attr('transform', `translate(${margin.left},0)`).call(\n          axisLeft(yScale)\n            .tickValues(yTicks)\n            .tickPadding(10)\n            .tickSize(-width + margin.right + margin.left - 1)\n            .tickFormat((v: any) => v)\n        )\n      )\n      .call((g) =>\n        g.select('.domain').attr(\n          'd',\n          (_d, _, path) =>\n            // close path so the domain has a right border\n            select(path[0]).attr('d') + 'z'\n        )\n      )\n  }, [gEl, yScale, width])\n\n  return <g className=\"y axis\" ref={nodeRef} />\n}\n","/* eslint-disable no-loop-func */\nimport { uniq } from 'lodash'\n\n/*\nPCPWM == updates at top\nPFCPWM == updates at bottom\nbut this should be passed from update OCRnX upate time bit value\n*/\ntype TimerMode = 'Normal' | 'PCPWM' | 'CTC' | 'FPWM' | 'PFCPWM'\ntype Counter = { tcnt: number; dir: number }\nconst tcntToCpu = ({ tcnt, dir }: Counter, top: number) => {\n  if (dir === -1) return 2 * top - tcnt\n  return tcnt\n}\nconst offsetCounter = (\n  counter: Counter,\n  offset: number,\n  top: number,\n  timerMode: TimerMode\n) => cpuToTcnt(tcntToCpu(counter, top) + offset, top, timerMode)\n\nconst getTimerLength = (top: number, timerMode: TimerMode) => {\n  const isDoubleSlope = ['PCPWM', 'PFCPWM'].includes(timerMode)\n  return isDoubleSlope ? top * 2 : top\n}\nconst cpuToTcnt = (cpu: number, top: number, timerMode: TimerMode) => {\n  while (cpu < 0) cpu += top\n  const isDoubleSlope = ['PCPWM', 'PFCPWM'].includes(timerMode)\n  if (!isDoubleSlope) {\n    // e.g top = 3\n    // 0 1 2 3 4 -- cpu\n    // 0 1 2 3 0 -- single slope\n    return { tcnt: cpu % (top + 1), dir: 1 }\n  }\n  // e.g top = 3\n  // 0 1 2 3 4 5 6\n  // 0 1 2 3 2 1 0 -- double slope\n  const tcnt = cpu % (top * 2)\n  if (tcnt < top) return { tcnt, dir: 1 }\n  return { tcnt: top * 2 - tcnt, dir: -1 }\n}\nconst matches = (a: Counter, b: Counter) => a.tcnt === b.tcnt && a.dir === b.dir\n\ntype Props = {\n  timerMode: TimerMode\n  prescaler: number\n  cpuHz: number\n  top: number\n  counterMax: number\n  tovTime: 'BOTTOM' | 'TOP' | 'MAX'\n  OCRnXs: number[]\n  OCRnXs_behaviour: (\n    | 'clear'\n    | 'set'\n    | 'set-on-match, clear-at-max'\n    | 'clear-on-match, set-at-max'\n    | 'toggle'\n    | 'clear-up, set-down'\n    | 'set-up, clear-down'\n  )[]\n  ICRn: number\n  deadTimeEnable: boolean\n  deadTimeA: number\n  deadTimeB: number\n}\nconst TOGGLE = -1\nexport default function simTimer({\n  timerMode,\n  prescaler,\n  cpuHz,\n  top,\n  counterMax,\n  tovTime,\n  OCRnXs,\n  OCRnXs_behaviour,\n  ICRn,\n  deadTimeEnable,\n  deadTimeA,\n  deadTimeB\n}: Props) {\n  const prescaledCPUEnd = getTimerLength(top, timerMode) * 4\n  const results = {\n    t: [] as number[],\n    cpu: [] as number[],\n    TCNT: [] as number[],\n    OCnXs: OCRnXs.map(() => [] as number[]),\n    MATCH_Xs: OCRnXs.map(() => [] as number[]),\n    OVF: [] as number[],\n    CAPT: [] as number[],\n    deadTimes: [[], []] as number[][],\n    freq: cpuHz / (getTimerLength(top, timerMode) + 1) / prescaler\n  }\n  if (isNaN(top)) return results\n  let OCnXs = OCRnXs.map(() => 0)\n  let deadTimes = [0, 0]\n\n  const actions = OCRnXs_behaviour.map((behaviour, i) => {\n    const action = {\n      at: [] as { tcnt: number; dir: number; to: number }[],\n      matchAt: OCRnXs[i],\n      behaviour\n    }\n    switch (behaviour) {\n      case 'set':\n        action.at = [{ tcnt: OCRnXs[i], dir: 1, to: 1 }]\n        break\n      case 'clear':\n        action.at = [{ tcnt: OCRnXs[i], dir: 1, to: 0 }]\n        break\n      case 'toggle':\n        action.at = [{ tcnt: OCRnXs[i], dir: 1, to: TOGGLE }]\n        break\n      case 'set-on-match, clear-at-max':\n        action.at = [\n          { tcnt: OCRnXs[i], dir: 1, to: 1 },\n          { tcnt: top, dir: 1, to: 0 }\n        ]\n        break\n      case 'clear-on-match, set-at-max':\n        action.at = [\n          { tcnt: OCRnXs[i], dir: 1, to: 0 },\n          { tcnt: top, dir: 1, to: 1 }\n        ]\n        break\n      case 'set-up, clear-down':\n        action.at = [\n          { tcnt: OCRnXs[i], dir: 1, to: 1 },\n          { tcnt: OCRnXs[i], dir: -1, to: 0 }\n        ]\n        break\n      case 'clear-up, set-down':\n        action.at = [\n          { tcnt: OCRnXs[i], dir: 1, to: 0 },\n          { tcnt: OCRnXs[i], dir: -1, to: 1 }\n        ]\n        break\n    }\n    OCnXs[i] = +!action.at[0]?.to || 0\n    return action\n  })\n\n  let actionDeadTimeA = [] as { tcnt: number; dir: number; to: number }[]\n  let actionDeadTimeB = [] as { tcnt: number; dir: number; to: number }[]\n\n  if (deadTimeEnable) {\n    /* deadtime \n      setB at setB + deadTimeB\n      changeA at setB (to !isAInverted)\n      clearB at clearB\n      changeA at clearB+deadTimeA (to isAInverted)\n    */\n    const bClear = actions[1].at.find(({ to }) => to === 0)!\n    const bSet = actions[1].at.find(({ to }) => to === 1)!\n    actionDeadTimeA = [{ to: 1, tcnt: bClear.tcnt, dir: bClear.dir }]\n    if (deadTimeA < top)\n      actionDeadTimeA.push({\n        to: 0,\n        ...offsetCounter(bClear, deadTimeA, top, timerMode)\n      })\n    actionDeadTimeB = [{ to: 1, tcnt: bSet.tcnt, dir: bSet.dir }]\n    if (deadTimeB < top)\n      actionDeadTimeB.push({\n        to: 0,\n        ...offsetCounter(bSet, deadTimeB, top, timerMode)\n      })\n  }\n  let tcntEventTimes = [\n    // Optimization:\n    // Things happen only when TCNT equals these values.\n    // values surounding the events are added to ensure the plot\n    // keeps the lines at their values until a change happens\n    0,\n    ...OCRnXs,\n    ICRn,\n    ...actionDeadTimeA.map(({ tcnt }) => tcnt),\n    ...actionDeadTimeB.map(({ tcnt }) => tcnt),\n    top,\n    counterMax\n  ].flatMap((n) => [n - 1, n, n + 1])\n\n  let prescaledCPU = -1\n  tcntEventTimes = uniq(tcntEventTimes)\n\n  let counter = {\n    tcnt: -1,\n    dir: 1\n  }\n  while (prescaledCPU < prescaledCPUEnd) {\n    const nextEvents = tcntEventTimes\n      .map((n) => (n - counter.tcnt) * counter.dir)\n      .filter((n) => n > 0)\n    let distToNext = Math.min(...nextEvents)\n    let MATCH_Xs = OCRnXs.map(() => 0)\n    let OVF = 0\n    let CAPT = 0\n    prescaledCPU += distToNext\n\n    counter = cpuToTcnt(prescaledCPU, top, timerMode)\n    if (counter.tcnt === 0 && tovTime === 'BOTTOM') OVF = 1\n    if (counter.tcnt === top && tovTime === 'TOP') OVF = 1\n    if (counter.tcnt === counterMax && tovTime === 'MAX') OVF = 1\n\n    actions.forEach(({ at, matchAt }, i) => {\n      at.forEach((action) => {\n        if (matches(counter, action)) {\n          OCnXs[i] = action.to === TOGGLE ? +!OCnXs[i] : action.to\n        }\n      })\n      ;[actionDeadTimeA, actionDeadTimeB].forEach((at, i) => {\n        at.forEach((action) => {\n          if (matches(counter, action)) {\n            deadTimes[i] = action.to\n          }\n        })\n      })\n      if (counter.tcnt === matchAt) MATCH_Xs[i] = 1\n    })\n\n    if (counter.tcnt === ICRn) CAPT = 1\n    results.t.push((prescaledCPU * prescaler) / cpuHz)\n    results.cpu.push(prescaledCPU * prescaler)\n    results.TCNT.push(counter.tcnt)\n    results.OVF.push(OVF)\n    results.CAPT.push(CAPT)\n    for (const i in OCRnXs_behaviour) {\n      results.OCnXs[i].push(OCnXs[i])\n      results.MATCH_Xs[i].push(MATCH_Xs[i])\n    }\n    for (const i in deadTimes) {\n      results.deadTimes[i].push(deadTimes[i])\n    }\n  }\n  if (deadTimeEnable) {\n    if (OCRnXs_behaviour[0] === OCRnXs_behaviour[1]) {\n      results.OCnXs[0] = results.OCnXs[1].map(\n        (b, i) => +(b || results.deadTimes[0][i])\n      )\n    } else {\n      results.OCnXs[0] = results.OCnXs[1].map(\n        (b, i) => +(!b && !results.deadTimes[0][i])\n      )\n    }\n    results.OCnXs[1] = results.OCnXs[1].map(\n      (b, i) => +(b && !results.deadTimes[1][i])\n    )\n  }\n  return results\n}\n\nexport type Simulation = ReturnType<typeof simTimer>\n","import {\n  forwardRef,\n  MouseEventHandler,\n  useCallback,\n  useImperativeHandle,\n  useState\n} from 'react'\nimport { margin } from './margin'\nimport './CompareRegisterHandle.css'\nimport { ScaleLinear } from 'd3-scale'\n\nexport type CompareRegisterHandleRef = {\n  onMouseUp: MouseEventHandler\n  onMouseMove: (n: number, e: MouseEvent | TouchEvent) => void\n}\ntype Props = {\n  width: number\n  yExtent: [number, number]\n  yScale: ScaleLinear<number, number>\n  setCompareRegisterValue: (n: number) => void\n  compareRegisterValue: number\n  name: string\n}\n\nconst constrain = (n: number, min: number, max: number) =>\n  Math.min(Math.max(n, min), max)\n\nconst CompareRegisterHandle = forwardRef<CompareRegisterHandleRef, Props>(\n  (\n    {\n      width,\n      yScale,\n      setCompareRegisterValue,\n      compareRegisterValue,\n      yExtent,\n      name\n    },\n    ref\n  ) => {\n    const [draggingTV, setDraggingTV] = useState(false)\n    useImperativeHandle(ref, () => ({\n      onMouseUp() {\n        setDraggingTV(false)\n      },\n      onMouseMove(y, e) {\n        e.preventDefault()\n        if (draggingTV) {\n          let scaled = yScale.invert(y)\n          scaled = constrain(Math.round(scaled), ...yExtent)\n          setCompareRegisterValue(scaled)\n        }\n      }\n    }))\n    let scaledY = yScale(constrain(compareRegisterValue, ...yExtent))\n    const onMouseDown = useCallback(\n      (e) => {\n        // e.preventDefault()\n        // e.stopPropagation()\n        setDraggingTV(true)\n      },\n      [setDraggingTV]\n    )\n    return (\n      <>\n        <line\n          className={`OCR ${name}`}\n          x1={margin.left}\n          x2={width - margin.right}\n          y1={scaledY}\n          y2={scaledY}\n        ></line>\n        <line\n          className={`OCRHandle ${name}`}\n          onMouseDown={onMouseDown}\n          onTouchStart={onMouseDown}\n          x1={margin.left}\n          x2={width}\n          y1={scaledY}\n          y2={scaledY}\n        ></line>\n        <text\n          className={`OCRText ${name}`}\n          fill=\"currentColor\"\n          onMouseDown={onMouseDown}\n          onTouchStart={onMouseDown}\n          y={scaledY}\n          x={width - margin.right}\n          dy=\".32em\"\n          dx=\"10\"\n        >\n          {name}={compareRegisterValue}\n        </text>\n      </>\n    )\n  }\n)\n\nCompareRegisterHandle.displayName = 'CompareRegisterHandle'\n\nexport default CompareRegisterHandle\n","import { ScaleLinear, line } from 'd3'\n\ntype Props = {\n  label: string\n  flagValues: number[]\n  t: number[]\n  TCNT: number[]\n  xScale: ScaleLinear<number, number>\n  yScale: ScaleLinear<number, number>\n}\nexport default function InterruptArrow({\n  label,\n  flagValues,\n  t,\n  TCNT,\n  xScale,\n  yScale\n}: Props) {\n  return (\n    <>\n      {flagValues.map(\n        (n, i) =>\n          n && (\n            <g\n              key={i}\n              transform={`translate(${xScale(t[i])}, ${yScale(TCNT[i])})`}\n            >\n              <path\n                d={\n                  line()([\n                    [-3, -5],\n                    [0, 0],\n                    [3, -5],\n                    [0, 0],\n                    [0, -12],\n                    [20, -12]\n                  ])!\n                }\n              />\n              <text key={i} y=\"-20\" x=\"0\" dy=\".32em\">\n                {label}\n              </text>\n            </g>\n          )\n      )}\n    </>\n  )\n}\n","import { ScaleLinear, line, CurveFactory, curveLinear } from 'd3'\nimport { margin } from './margin'\n\nimport './Curve.css'\n\ntype CurvesProps = {\n  data: [number, number][]\n  xScale: ScaleLinear<number, number>\n  yScale: ScaleLinear<number, number>\n  idx: any\n  name?: string\n  curve?: CurveFactory\n}\n\nexport function Curve({\n  xScale,\n  yScale,\n  data,\n  idx,\n  name,\n  curve = curveLinear\n}: CurvesProps) {\n  const theLine = line<[number, number]>()\n    .x(([t, datum]) => xScale(t)!)\n    .y(([t, datum]) => yScale(datum)!)\n    .curve(curve)\n\n  const d = theLine(data)\n  return (\n    <>\n      <path className={`curve-${idx}`} d={d || undefined}></path>\n      {name && (\n        <text\n          className={`OCText ${name}`}\n          fill=\"currentColor\"\n          y={yScale(0)}\n          x={xScale(0) - margin.left}\n          dy=\".32em\"\n          dx=\"10\"\n        >\n          {name}\n        </text>\n      )}\n    </>\n  )\n}\n","import { TRow } from './types'\n\nexport type GenericCompRegName =\n  | 'OutputA'\n  | 'OutputB'\n  | 'OutputC'\n  | 'Input'\n  | 'DeadTimeA'\n  | 'DeadTimeB'\n\nconst getName = (genericName: GenericCompRegName, values: TRow) =>\n  ({\n    OutputA: `OCR${values.timerNr}A`,\n    OutputB: `OCR${values.timerNr}B`,\n    OutputC: `OCR${values.timerNr}C`,\n    Input: `ICR${values.timerNr}`,\n    DeadTimeA: `DTR${values.timerNr}L`,\n    DeadTimeB: `DTR${values.timerNr}H`\n  }[genericName])\n\nconst getIsTop = (genericName: GenericCompRegName, values: TRow) =>\n  values.topValue === getName(genericName, values)\nconst getIsInterrupt = (genericName: GenericCompRegName, values: TRow) =>\n  values[\n    {\n      OutputA: `OCIE${values.timerNr}A`,\n      OutputB: `OCIE${values.timerNr}B`,\n      OutputC: `OCIE${values.timerNr}C`,\n      Input: `ICIE${values.timerNr}`,\n      DeadTimeA: `DTRL${values.timerNr}`,\n      DeadTimeB: `DTRH${values.timerNr}`\n    }[genericName]\n  ] === '1'\nconst getIsActiveOutput = (genericName: GenericCompRegName, values: TRow) =>\n  (values[\n    {\n      OutputA: `CompareOutputModeA`,\n      OutputB: `CompareOutputModeB`,\n      OutputC: `CompareOutputModeC`,\n      Input: ``,\n      DeadTimeA: ``,\n      DeadTimeB: ``\n    }[genericName]\n  ] || 'disconnect') !== 'disconnect'\nconst getIsActiveDeadTime = (genericName: GenericCompRegName, values: TRow) =>\n  values[\n    {\n      OutputA: ``,\n      OutputB: ``,\n      OutputC: ``,\n      Input: ``,\n      DeadTimeA: `DeadTime`,\n      DeadTimeB: `DeadTime`\n    }[genericName]\n  ] === 'on'\nconst getIsUsed = (genericName: GenericCompRegName, values: TRow) =>\n  getIsTop(genericName, values) ||\n  getIsInterrupt(genericName, values) ||\n  (getIsActiveOutput(genericName, values) &&\n    !(genericName === 'OutputA' && values.DeadTime === 'on')) ||\n  getIsActiveDeadTime(genericName, values)\n\nconst getIsInput = (genericName: GenericCompRegName) =>\n  ({\n    OutputA: false,\n    OutputB: false,\n    OutputC: false,\n    Input: true,\n    DeadTimeA: false,\n    DeadTimeB: false\n  }[genericName])\nconst getIsOutput = (genericName: GenericCompRegName) =>\n  ({\n    OutputA: true,\n    OutputB: true,\n    OutputC: true,\n    Input: false,\n    DeadTimeA: false,\n    DeadTimeB: false\n  }[genericName])\nconst getIsDeadTime = (genericName: GenericCompRegName) =>\n  ({\n    OutputA: false,\n    OutputB: false,\n    OutputC: false,\n    Input: false,\n    DeadTimeA: true,\n    DeadTimeB: true\n  }[genericName])\n\nexport const compareRegs: GenericCompRegName[] = [\n  'OutputA',\n  'OutputB',\n  'OutputC',\n  'Input',\n  'DeadTimeA',\n  'DeadTimeB'\n]\n\nexport const getCompareRegTraits = (\n  genericName: GenericCompRegName,\n  values: TRow\n) => {\n  const name = getName(genericName, values)\n  const value = parseFloat(values[name] || '')\n  // if (Number.isNaN(value)) debugger\n  return {\n    genericName: genericName,\n    name,\n    value,\n    code: `${name} = ${value};`,\n    isInput: getIsInput(genericName),\n    isOutput: getIsOutput(genericName),\n    isDeadTime: getIsDeadTime(genericName),\n    isActiveOutput: getIsActiveOutput(genericName, values),\n    isTop: getIsTop(genericName, values),\n    isInterrupt: getIsInterrupt(genericName, values),\n    isUsed: getIsUsed(genericName, values)\n  }\n}\nexport const getAllCompareRegTraits = (values: TRow) =>\n  compareRegs.map((genericName) => getCompareRegTraits(genericName, values))\n","import { debounce } from 'lodash'\nimport { useState, useEffect } from 'react'\n\nconst sleep = (ms: number) => new Promise((r) => setTimeout(r, ms))\n\nlet lock = false\n\nexport const setHashFromObject = debounce(\n  // debounced to avoid chrome throttling\n  async (record: Record<string, string | undefined>) => {\n    const cleanRecord = Object.fromEntries(\n      Object.entries(record).filter(([, val]) => val !== undefined)\n    ) as Record<string, string>\n    const newHash = new URLSearchParams(cleanRecord).toString()\n    lock = true\n    window.location.replace(`${window.location.pathname}#${newHash}`)\n    await sleep(0)\n    lock = false\n  },\n  100,\n  { leading: false, trailing: true, maxWait: 100 }\n)\n\nexport const getHashParams = () => {\n  const hash = window.location.hash.slice(1)\n  return new URLSearchParams(hash)\n}\n\nexport const useHashChangedExternally = () => {\n  const [state, setState] = useState<URLSearchParams>(getHashParams())\n  useEffect(() => {\n    const handleHashChange = () => {\n      if (!lock) setState(getHashParams())\n    }\n    window.addEventListener('hashchange', handleHashChange)\n    return () => window.removeEventListener('hashchange', handleHashChange)\n  }, [])\n\n  return Object.fromEntries(state.entries())\n}\n","import raw from 'raw.macro'\nimport { tsv, tsvConstraints } from '../timers'\n\n// const timers = [timer0, timer1, timer2, timer3]\nconst timers = [\n  tsv(raw('./timer0.tsv')),\n  tsv(raw('./timer1.tsv')),\n  tsv(raw('./timer2.tsv')),\n  tsv(raw('./timer3.tsv'))\n]\n\ntimers.forEach((t) =>\n  t.configs.push(\n    tsvConstraints(`\nFCPU\tFCPU_UI\n32000000\t32Mhz\n16000000\t16Mhz\n8000000\t8Mhz\n4000000\t4Mhz\n2000000\t2Mhz\n1000000\t1Mhz\n`)\n  )\n)\nexport default timers\n","import raw from 'raw.macro'\nimport { tsv, tsvConstraints } from '../timers'\n\n// const timers = [timer0, timer1, timer2, timer3]\nconst timers = [\n  tsv(raw('./timer0.tsv')),\n  tsv(raw('./timer1.tsv')),\n  tsv(raw('./timer2.tsv'))\n]\n\ntimers.forEach((t) =>\n  t.configs.push(\n    tsvConstraints(`\nFCPU\tFCPU_UI\n16000000\t16Mhz\n20000000\t20Mhz\n8000000\t8Mhz\n4000000\t4Mhz\n2000000\t2Mhz\n1000000\t1Mhz\n`)\n  )\n)\nexport default timers\n","export type TTableNames = string\n\nexport type TRow = {\n  [k: string]: string\n}\nexport type TTable = TRow[]\nexport type TTimerConfig = TTable[]\n\nexport type TTimerRegisters = {\n  [k: string]: string[]\n}\nexport type TDescriptions = {\n  [k: string]: string\n}\n\nexport type TDefaultState = TRow\n\nexport type TTimer = {\n  configs: TTimerConfig\n  registers: TTimerRegisters\n  timerNr: number\n}\nexport enum PanelModes {\n  Normal = 'Normal',\n  Internal = 'With Internals',\n  ByDependencies = 'By Dependencies'\n}\nexport enum MicroControllers {\n  LGT8F328P = 'LGT8F328P',\n  ATMEGA328P = 'ATMEGA328P'\n}\n","import lgt328p from './lgt328p'\nimport atmega328p from './atmega328p'\nimport { MicroControllers } from '../helpers/types'\n// Timer tables: https://docs.google.com/spreadsheets/d/1VDKsVMj4c5aOxKWu2UroWFAeODwbeVwksYxhjtuEopI/edit#gid=1264839381\nconst timers = {\n  [MicroControllers.LGT8F328P]: lgt328p,\n  [MicroControllers.ATMEGA328P]: atmega328p\n}\n\nexport default timers\n","import {\n  atom,\n  atomFamily,\n  DefaultValue,\n  selector,\n  selectorFamily,\n  useRecoilValue,\n  useSetRecoilState\n} from 'recoil'\nimport { setHashFromObject, useHashChangedExternally } from './useHash'\n\nimport timers from '../data'\nimport { MicroControllers, PanelModes } from '../helpers/types'\nimport { uniq, without } from 'lodash'\n\nexport const panelModeState = atom({\n  key: 'PanelModeState',\n  default: PanelModes.Normal\n})\nconst defaultState: Record<string, string> = {\n  mcu: MicroControllers.ATMEGA328P,\n  timer: '0'\n}\n\nexport const RegisterHashUpdater = () => {\n  const set = useSetRecoilState(userConfigStateBulk)\n  const params = useHashChangedExternally()\n  set(params)\n  return <></>\n}\nexport const RegisterHashWatcher = () => {\n  const obj = useRecoilValue(userConfigStateBulk)\n  setHashFromObject({ ...defaultState, ...obj })\n  return <></>\n}\nexport const RegisterHashLink = () => {\n  return (\n    <>\n      <RegisterHashWatcher />\n      <RegisterHashUpdater />\n    </>\n  )\n}\n\nconst userConfigState_vars = atom<string[]>({\n  key: 'userConfigState_vars',\n  default: [],\n\n  // The hack is to instantly update the userConfigState_vars array\n  // otherwise it is imposible to accumulate the list of used variables in the family.\n  // This is because subsequent synchronous calls to set an atom don't update their previous state.\n  dangerouslyAllowMutability: true\n})\n\nconst userConfigState_store = atomFamily<string | undefined, string>({\n  key: 'userConfigState_store',\n  default: (variable) => defaultState[variable]\n})\n\nexport const userConfigState = selectorFamily<string | undefined, string>({\n  key: 'userConfigState',\n  get:\n    (variable: string) =>\n    ({ get }) =>\n      get(userConfigState_store(variable)),\n  set:\n    (variable: string) =>\n    ({ set }, value) => {\n      if (value instanceof DefaultValue) value = undefined\n      set(userConfigState_store(variable), value)\n      set(userConfigState_vars, (vars_old) => {\n        let vars_new =\n          value === undefined\n            ? without(vars_old, variable)\n            : uniq([...vars_old, variable])\n        vars_old.length = 0\n        vars_old.push(...vars_new)\n        return vars_new\n      })\n    }\n})\n\nexport const userConfigStateBulk = selector<Record<string, string | undefined>>(\n  {\n    key: 'userConfigStateBulk',\n    get: ({ get }) => {\n      const got = Object.fromEntries(\n        get(userConfigState_vars).map((variable) => [\n          variable,\n          get(userConfigState(variable))\n        ])\n      ) as Record<string, string>\n      return got\n    },\n    set: ({ get, set }, value) => {\n      if (value instanceof DefaultValue) return console.warn('why')\n      const variables = uniq([\n        ...get(userConfigState_vars),\n        ...Object.keys(value)\n      ])\n      for (const variable of variables) {\n        // problem is here: userConfigStte needs the bulk and it sets it wrong\n        set(userConfigState(variable), value[variable])\n      }\n    }\n  }\n)\n\nexport const mcuTimers = selector({\n  key: 'mcuTimers',\n  get: ({ get }) => {\n    const micro = get(userConfigState('mcu')) as MicroControllers\n    return timers[micro]\n  }\n})\nexport const timerState = selector({\n  key: 'timerState',\n  get: ({ get }) => get(mcuTimers)[+(get(userConfigState('timer')) || 0)]\n})\n","import { TTable } from './types'\n\nimport uniq from 'lodash/uniq'\nimport intersection from 'lodash/intersection'\nimport { remove } from 'lodash'\n\nexport const splitTables = ([left, ...tables]: TTable[]): TTable[][] => {\n  if (!left) return []\n  const cluster = [left]\n  let remaining: TTable[] = []\n  let colsLeft = Object.keys(left[0])\n  let changed\n  do {\n    changed = false\n    remaining = []\n\n    for (const table of tables) {\n      const colsRight = Object.keys(table[0])\n      const match = intersection(colsLeft, colsRight).length > 0\n      if (match) {\n        cluster.push(table)\n        colsLeft = uniq([...colsLeft, ...colsRight])\n        changed = true\n      } else {\n        remaining.push(table)\n      }\n    }\n    tables = remaining\n  } while (changed)\n\n  return [cluster, ...splitTables(remaining)]\n}\nexport function isTruthy<TValue>(value: TValue | undefined): value is TValue {\n  return !!value\n}\n\nexport const WILDCARD = '*'\nexport const getFullDomains = (tables: TTable[]): Record<string, string[]> => {\n  const domains: Record<string, string[]> = {}\n  for (const table of tables) {\n    for (const row of table) {\n      for (const [variable, value] of Object.entries(row)) {\n        domains[variable] = domains[variable] || []\n        if (value !== WILDCARD && !value.startsWith('!')) {\n          if (!domains[variable].includes(value)) domains[variable].push(value)\n        }\n      }\n    }\n  }\n  return domains\n}\nexport const getConstrainedDomains = (\n  tables: TTable[],\n  domains_?: Record<string, string[]>\n): Record<string, string[]> => {\n  const domains: Record<string, string[]> = domains_\n    ? { ...domains_ }\n    : getFullDomains(tables)\n  let done = false\n  while (!done) {\n    done = true\n    for (const table_ of tables) {\n      // first remove all rows containing a value out of a variable's domain\n      const table = table_.filter((row) => {\n        return Object.entries(row).every(([variable, value]) => {\n          if (value === WILDCARD) return true\n          if (value.startsWith('!')) {\n            const negated = value.slice(1)\n            return domains[variable].some((value) => value !== negated)\n          }\n          return domains[variable].includes(value)\n        })\n      })\n      // then update the domain of each variable to only the values avalable in the current table\n      for (const variable of Object.keys(table[0] || {})) {\n        // todo handle numerics\n        const values = table.map((row) => row[variable])\n        const hasWildcards = values.includes(WILDCARD)\n        if (hasWildcards) continue\n        const negatedVals = remove(values, (val) => val?.startsWith('!')).map(\n          (val) => val?.slice(1)\n        )\n        const positiveVals = values // there are no wildcards, and negateds were already removed\n        const miniDomain = uniq([\n          ...positiveVals,\n          ...negatedVals.flatMap((negated) =>\n            domains[variable].filter((value) => value !== negated)\n          )\n        ])\n        const sizeBefore = domains[variable].length\n        domains[variable] = intersection(domains[variable], miniDomain)\n        const sizeAfter = domains[variable].length\n        if (sizeBefore !== sizeAfter) done = false\n      }\n    }\n  }\n  return domains\n}\n","import { mapValues, uniq } from 'lodash'\nimport { selector, selectorFamily } from 'recoil'\nimport {\n  getConstrainedDomains,\n  splitTables,\n  getFullDomains\n} from '../helpers/helpers'\nimport { TRow, TTable } from '../helpers/types'\nimport { timerState, userConfigState } from '../state/state'\n\nexport const groupsState = selector({\n  key: 'groupsState',\n  get: ({ get }) => splitTables(get(timerState).configs)\n})\nexport const groupState = selectorFamily({\n  key: 'groupsState',\n  get:\n    (groupIdx: number) =>\n    ({ get }) => {\n      const tableSets = get(groupsState)\n      return tableSets[groupIdx]\n    }\n})\n\nconst getVariables = (group: TTable[]) => {\n  if (group === undefined) debugger\n  return uniq(group.flatMap((table: TTable) => Object.keys(table[0])))\n}\nexport const suggestedGroupAssignmentState = selectorFamily({\n  key: 'suggestedGroupAssignmentState',\n  get:\n    (groupIdx: number) =>\n    ({ get }) => {\n      const userState = get(groupConfigState(groupIdx))\n      const group = get(groupState(groupIdx))\n      let domains = get(constrainedGroupDomainsState(groupIdx))\n      const instantiations: Record<string, string> = {}\n      for (const variable of Object.keys(domains)) {\n        if (domains[variable].length < 2) continue // if the domain of a var is only one element, there's no need to assign it.\n        instantiations[variable] = domains[variable][0]\n        domains = getConstrainedDomains(\n          [[instantiations], [userState], ...group],\n          domains\n        )\n      }\n      return mapValues(domains, (domain) => domain[0])\n    }\n})\n\nexport const suggestedVariableAssignmentState = selectorFamily({\n  key: 'suggestedVarAssignmentState',\n  get:\n    (variable: string) =>\n    ({ get }) => {\n      const groupIdx = get(groupIdxFromVariableState(variable))\n      if (groupIdx === -1) return undefined\n\n      return get(suggestedGroupAssignmentState(groupIdx))[variable]\n    }\n})\nexport const suggestedAssignmentState = selector<TRow>({\n  key: 'suggestedAssignmentState',\n  get: ({ get }) => {\n    const assignments = get(groupsState)\n      .map((_, i) => get(suggestedGroupAssignmentState(i)))\n      .flat()\n    return Object.assign({}, ...assignments)\n  }\n})\n\nexport const groupConfigState = selectorFamily({\n  key: 'groupConfigState',\n  get:\n    (groupIdx: number) =>\n    ({ get }) => {\n      const group = get(groupState(groupIdx))\n      const relevantVariables = getVariables(group)\n      const userConfig: TRow = {}\n      for (const variable of relevantVariables) {\n        const userValue = get(userConfigState(variable))\n        if (userValue !== undefined) userConfig[variable] = userValue\n      }\n      return userConfig\n    }\n})\n\nexport const groupIdxFromVariableState = selectorFamily({\n  key: 'groupIdxFromVariableState',\n  get:\n    (variable: string) =>\n    ({ get }) => {\n      const tableSets = get(groupsState)\n      const idx = tableSets.findIndex((group) =>\n        group.some((table) => table[0].hasOwnProperty(variable))\n      )\n      return idx\n    }\n})\nexport const groupFromVariableState = selectorFamily({\n  key: 'groupFromVariableState',\n  get:\n    (variable: string) =>\n    ({ get }) => {\n      const tableSets = get(groupsState)\n      const idx = get(groupIdxFromVariableState(variable))\n      return tableSets[idx]\n    }\n})\nexport const constrainedGroupDomainsState = selectorFamily({\n  key: 'constrainedGroupDomainsState',\n  get:\n    (groupIdx: number) =>\n    ({ get }) => {\n      const group = get(groupState(groupIdx))\n      const userState = get(groupConfigState(groupIdx))\n      return getConstrainedDomains([[userState], ...group])\n    }\n})\nexport const fullGroupDomainsState = selectorFamily({\n  key: 'fullGroupDomainsState',\n  get:\n    (groupIdx: number) =>\n    ({ get }) => {\n      const group = get(groupState(groupIdx))\n      const userState = get(groupConfigState(groupIdx))\n      return getFullDomains([...group, [userState]])\n    }\n})\nexport const constrainedDomainState = selectorFamily({\n  key: 'constrainedDomainState',\n  get:\n    (variable: string) =>\n    ({ get }) => {\n      const groupIdx = get(groupIdxFromVariableState(variable))\n      return get(constrainedGroupDomainsState(groupIdx))[variable]\n    }\n})\nexport const fullDomainState = selectorFamily({\n  key: 'fullDomainState',\n  get:\n    (variable: string) =>\n    ({ get }) => {\n      const groupIdx = get(groupIdxFromVariableState(variable))\n      return get(fullGroupDomainsState(groupIdx))[variable]\n    }\n})\n\nexport const variableOptionsState = selectorFamily({\n  key: 'variableOptionsState',\n  get:\n    (variable: string) =>\n    ({ get }) => {\n      const groupIdx = get(groupIdxFromVariableState(variable))\n      const userState = get(groupConfigState(groupIdx))\n      const fullDomains = get(fullDomainState(variable))\n\n      const group = get(groupState(groupIdx))\n      let constrainedDomain = get(constrainedDomainState(variable))\n      if (userState[variable]) {\n        const { [variable]: _discarded, ...selectedWithout } = userState\n        constrainedDomain = getConstrainedDomains([\n          [selectedWithout],\n          ...group\n        ])[variable]\n      }\n      const defaultValue = get(suggestedVariableAssignmentState(variable))\n      const forcedOption =\n        !userState[variable] && constrainedDomain.length === 1\n          ? constrainedDomain[0]\n          : undefined\n      const suggestedOption =\n        !userState[variable] && constrainedDomain.length > 1\n          ? defaultValue\n          : undefined\n      return {\n        variable,\n        selectedOption: userState[variable],\n        suggestedOption: suggestedOption || forcedOption || userState[variable],\n        forcedOption: forcedOption,\n        options: fullDomains.map((value) => ({\n          isSuggested: value === suggestedOption,\n          value,\n          isDisabled: !constrainedDomain.includes(value) || !!forcedOption\n        }))\n      }\n    }\n})\n\nexport type TCheckboxGroupData = {\n  variable: string\n  selectedOption: string | undefined\n  suggestedOption: string | undefined\n  forcedOption: string | undefined\n  options: {\n    isSuggested: boolean\n    value: string\n    isDisabled: boolean\n  }[]\n}[]\nexport type TCheckboxMinimalGroupData = {\n  variable: string\n  options: {\n    value: string\n  }[]\n}[]\n","import { useEffect, useRef, useState } from 'react'\nimport useSize from '@react-hook/size'\nimport { Tag } from 'rsuite'\n\nimport XAxis, { formatFreq, formatTime } from './XAxis'\nimport YAxis from './YAxis'\nimport { scaleLinear, extent, curveStepAfter } from 'd3'\nimport { margin } from './margin'\nimport simTimer from '../helpers/simulator'\n\nimport './Plot.css'\nimport CompareRegisterHandle, {\n  CompareRegisterHandleRef\n} from './CompareRegisterHandle'\nimport InterruptArrow from './InterruptArrow'\nimport { Curve } from './Curve'\nimport {\n  getAllCompareRegTraits,\n  getCompareRegTraits\n} from '../helpers/compareRegisterUtil'\nimport { useRecoilValue, useSetRecoilState } from 'recoil'\nimport { userConfigState } from '../state/state'\nimport { suggestedAssignmentState } from '../Panes/state'\n\nfunction usePrevious<T>(value: T) {\n  const ref = useRef<T>()\n  useEffect(() => {\n    ref.current = value\n  })\n  return ref.current\n}\n\ntype Props = {\n  style: Object\n}\nfunction Freq({ freq }: { freq: number }) {\n  const [mode, setMode] = useState(true)\n  return (\n    <Tag onClick={() => setMode(!mode)} className=\"frequency\">\n      {mode\n        ? `\n        Freq: ${formatFreq(freq)}\n        `\n        : `Period: ${formatTime(1 / freq)}`}\n    </Tag>\n  )\n}\nexport default function Plot({ style }: Props) {\n  const values = useRecoilValue(suggestedAssignmentState)\n  const counterMax = parseInt(values.counterMax)\n  const param = {\n    timerNr: values.timerNr,\n    timerMode: values.timerMode as any,\n    prescaler:\n      values.clockPrescalerOrSource === 'disconnect'\n        ? NaN\n        : parseInt(values.clockPrescalerOrSource) ||\n          parseInt(values.FCPU) / 1000,\n    cpuHz:\n      parseInt(values.FCPU || '1') * (values.clockDoubler === 'on' ? 2 : 1),\n    top: 0,\n    counterMax: parseInt(values.counterMax),\n    tovTime: values.setTovMoment as any,\n    OCRnXs: [] as number[],\n    OCRnXs_behaviour: [\n      values.CompareOutputModeA as any,\n      values.CompareOutputModeB as any,\n      values.CompareOutputModeC as any\n    ],\n    ICRn: 0,\n    deadTimeEnable: values.DeadTime === 'on',\n    deadTimeA: getCompareRegTraits('DeadTimeA', values).value,\n    deadTimeB: getCompareRegTraits('DeadTimeB', values).value\n  }\n\n  const IOCR_states = getAllCompareRegTraits(values).map((traits, i) => ({\n    ...traits,\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    ref: useRef<CompareRegisterHandleRef>(null),\n    i\n  }))\n\n  param.OCRnXs = IOCR_states.filter(({ isOutput }) => isOutput).map(\n    ({ value }) => value\n  )\n\n  param.ICRn = IOCR_states.find(({ isInput }) => isInput)!.value\n\n  param.top =\n    IOCR_states.find(({ isTop }) => isTop)?.value ?? parseInt(values.topValue)\n  const ocrMax = parseInt(values.topValue) || counterMax\n\n  /* TODO: put somewhere else */\n  /* DEFAULTS FOR COMPARE REGISTERS */\n  {\n    const prev = usePrevious(IOCR_states)\n    const ioCount = IOCR_states.filter(({ isDeadTime }) => !isDeadTime).length\n    let nth = 0\n    IOCR_states.forEach((iocr, i) => {\n      // eslint-disable-next-line react-hooks/rules-of-hooks\n      const setReg = useSetRecoilState(userConfigState(iocr.name))\n      const top = param.top || Number.parseInt(values.counterMax)\n      if (!iocr.isDeadTime) nth++\n      if (Number.isNaN(iocr.value) && iocr.isUsed) {\n        const n = iocr.isDeadTime\n          ? Math.pow(counterMax, 0.3)\n          : (top / (ioCount + 2)) * (nth + 1)\n        setReg('' + Math.round(n))\n      }\n      if (prev?.[i].isUsed && !iocr.isUsed) {\n        setReg(undefined)\n      }\n    })\n  }\n  /* --- */\n  const simulation = simTimer(param)\n  const containerRef = useRef<HTMLDivElement>(null)\n  const [width, height_] = useSize(containerRef)\n  const height_ouputCompare = 30\n  const margin_ouputCompare = 10\n  const activeOCnXs = IOCR_states.filter(({ isActiveOutput }) => isActiveOutput)\n  const height_timer =\n    height_ - height_ouputCompare * (activeOCnXs.length + 0.5)\n  const xScale = scaleLinear()\n    .domain(extent(simulation.t) as [number, number])\n    .range([margin.left, width - margin.right])\n  const yScale = scaleLinear()\n    .domain([0, ocrMax])\n    .rangeRound([height_timer - margin.bottom, margin.top])\n\n  useEffect(() => {\n    const containerEl = containerRef.current\n\n    const handleMouseUp = (e: Event) => {\n      IOCR_states.forEach(({ ref }) => ref.current?.onMouseUp(undefined as any))\n    }\n    const handleMouseMove = (e: MouseEvent | TouchEvent) => {\n      if (!containerEl) return\n      let y = e instanceof MouseEvent ? e.clientY : e.targetTouches[0].clientY\n      const targetY = containerEl.getBoundingClientRect().y\n      const offsetY = y - targetY\n      IOCR_states.forEach(({ ref }) => ref.current?.onMouseMove(offsetY, e))\n    }\n    document.addEventListener('mouseup', handleMouseUp)\n    document.addEventListener('touchend', handleMouseUp)\n    containerEl?.addEventListener('mousemove', handleMouseMove, {\n      passive: false\n    })\n    containerEl?.addEventListener('touchmove', handleMouseMove, {\n      passive: false\n    })\n    return () => {\n      document.removeEventListener('mouseup', handleMouseUp)\n      document.removeEventListener('touchend', handleMouseUp)\n      containerEl?.removeEventListener('mousemove', handleMouseMove)\n      containerEl?.removeEventListener('touchmove', handleMouseMove)\n    }\n  }, [IOCR_states])\n  return (\n    <div className=\"plotContainer\" ref={containerRef} style={style}>\n      <Freq freq={Math.round(simulation.freq * 100) / 100} />\n      <svg className=\"plot\">\n        <XAxis {...{ xScale, height: height_timer, data: simulation }} />\n        <YAxis {...{ yScale, width }} />\n        <Curve\n          {...{\n            xScale,\n            yScale,\n            width,\n            height: height_timer,\n            data: simulation.t.map((t, i) => [t, simulation.TCNT[i]]),\n            idx: 'TCNT',\n            key: 'TCNT'\n          }}\n        />\n        {activeOCnXs.map(({ isActiveOutput, i }, k) => {\n          const yScale = scaleLinear()\n            .domain([0, 1])\n            .rangeRound([\n              height_timer + height_ouputCompare * (k + 1),\n              height_timer + height_ouputCompare * k + margin_ouputCompare\n            ])\n          return (\n            <>\n              {isActiveOutput && (\n                <Curve\n                  {...{\n                    key: 'OC' + i,\n                    idx: i,\n                    curve: curveStepAfter,\n                    name: 'OC' + param.timerNr + 'ABC'[i],\n                    xScale,\n                    yScale,\n                    data: simulation.t.map((t, j) => [\n                      t,\n                      simulation.OCnXs[i][j]\n                    ])\n                  }}\n                />\n              )}\n              {param.deadTimeEnable && i < 2 && (\n                <Curve\n                  {...{\n                    key: 'DeadTime-' + i,\n                    idx: 'DeadTime-' + i,\n                    curve: curveStepAfter,\n                    name: '',\n                    xScale,\n                    yScale,\n                    data: [\n                      [0, 0],\n                      ...simulation.t.map((t, j) => [\n                        t,\n                        simulation.deadTimes[i][j]\n                      ]),\n                      [simulation.t[simulation.t.length - 1], 0]\n                    ] as [number, number][]\n                  }}\n                />\n              )}\n            </>\n          )\n        })}\n\n        {simulation.MATCH_Xs.flatMap(\n          (matches, i) =>\n            IOCR_states[i].isInterrupt && (\n              <InterruptArrow\n                {...{\n                  key: i + 'interrupt',\n                  flagValues: matches,\n                  TCNT: simulation.TCNT,\n                  t: simulation.t,\n                  xScale,\n                  yScale,\n                  label: 'OCR' + values.timerNr + 'ABC'[i] + ' interrupt'\n                }}\n              />\n            )\n        )}\n        {IOCR_states.find(({ isInput }) => isInput)!.isInterrupt && (\n          <InterruptArrow\n            {...{\n              flagValues: simulation.CAPT,\n              TCNT: simulation.TCNT,\n              t: simulation.t,\n              xScale,\n              yScale,\n              label: 'Capture interrupt',\n              key: 'Capture interrupt'\n            }}\n          />\n        )}\n        {values.InterruptOnTimerOverflow === 'on' && (\n          <InterruptArrow\n            {...{\n              flagValues: simulation.OVF,\n              TCNT: simulation.TCNT,\n              t: simulation.t,\n              xScale,\n              yScale,\n              label: 'Overflow interrupt',\n              key: 'Overflow interrupt'\n            }}\n          />\n        )}\n\n        {IOCR_states.map(({ isUsed, ref, value, name }) => {\n          // eslint-disable-next-line react-hooks/rules-of-hooks\n          const setUserConfigValue = useSetRecoilState(userConfigState(name))\n\n          // TODO: redo the extent thing with DTRs\n          const yExtent2: [number, number] = name.startsWith('DTR')\n            ? [0, Math.sqrt(counterMax + 1) - 1]\n            : [0, ocrMax]\n          const yScale = scaleLinear()\n            .domain(yExtent2)\n            .rangeRound([height_timer - margin.bottom, margin.top])\n          return (\n            isUsed && (\n              <CompareRegisterHandle\n                {...{\n                  key: name,\n                  ref,\n                  width,\n                  yExtent: yExtent2,\n                  yScale,\n                  compareRegisterValue: value,\n                  setCompareRegisterValue: (val: number) =>\n                    // eslint-disable-next-line react-hooks/rules-of-hooks\n                    setUserConfigValue(val + ''),\n                  name\n                }}\n              />\n            )\n          )\n        })}\n      </svg>\n    </div>\n  )\n}\n","import { map } from 'lodash'\nimport { useRecoilValue } from 'recoil'\nimport { getAllCompareRegTraits } from '../helpers/compareRegisterUtil'\nimport { isTruthy } from '../helpers/helpers'\nimport { timerState } from '../state/state'\nimport {\n  suggestedAssignmentState,\n  suggestedVariableAssignmentState\n} from './state'\nimport { Button } from 'rsuite'\nimport copy from 'copy-to-clipboard'\nimport React, { useEffect, useRef, useState } from 'react'\nconst omitRegisterZeros = true\n\nfunction LinkToThisPage() {\n  const [url, setUrl] = useState(window.location.href)\n  useEffect(() => {\n    const handleUrlChange = () => {\n      setUrl(window.location.href)\n    }\n    window.addEventListener('hashchange', handleUrlChange)\n    return () => window.removeEventListener('hashchange', handleUrlChange)\n  }, [])\n  return <>{'/* ' + url + ' */\\n'}</>\n}\nexport default function Code() {\n  const codeContainerRef = useRef<HTMLPreElement>(null)\n  return (\n    <>\n      <CopyToClipboard codeContainerRef={codeContainerRef} />\n      <pre style={{ margin: 0 }} ref={codeContainerRef}>\n        {`\\\nvoid setup(){\n  `}\n        <LinkToThisPage />\n        {`  noInterrupts();\\n`}\n        <TimerConfgCode />\n        <CompareRegsCode />\n        {`  interrupts();\n}\n`}\n        <Interrupts />\n      </pre>\n    </>\n  )\n}\nconst TimerConfgCode = () => {\n  const omitZeroValues = true\n  const { registers } = useRecoilValue(timerState)\n  const code = map(registers, (variables, regName) => {\n    const assignments = variables\n      .map((variable) => {\n        const value =\n          // eslint-disable-next-line react-hooks/rules-of-hooks\n          useRecoilValue(suggestedVariableAssignmentState(variable)) || '0'\n        if (omitZeroValues && value === '0') return ''\n\n        // DTR0L/H are special because they are just 4 bytes of a single register\n        if (variable === 'DTR0L') return `${value}`\n        if (variable === 'DTR0H') return `${value} << 4`\n        return `${value} << ${variable}`\n      })\n      .filter(isTruthy)\n    const assignmentsStr = assignments.length\n      ? `\\n    ${assignments.join(' |\\n    ')}`\n      : '0'\n    if (omitRegisterZeros && assignmentsStr === '0') return ''\n    // register names like PMX0_0 and PMX0_1 are actually all the same register,\n    // but they have to be set in two steps\n    return `  ${regName.split('_')[0]} = ${assignmentsStr};`\n  })\n    .flat()\n    .filter(isTruthy)\n  let str = code.join('\\n')\n  if (str.length) str += '\\n'\n  return <>{str}</>\n}\nfunction CompareRegsCode() {\n  const suggestedConfig = useRecoilValue(suggestedAssignmentState)\n\n  const code = getAllCompareRegTraits(suggestedConfig)\n    .filter(({ isUsed }) => isUsed)\n    // DTR0L/H are special because they are just 4 bytes of a single register\n    .filter(({ name }) => !['DTR0L', 'DTR0H'].includes(name))\n    .map(({ code }) => code)\n  let str = code.join('\\n  ')\n  if (str.length) str = '  ' + str + '\\n'\n  return <>{str}</>\n}\nfunction Interrupts() {\n  const interruptVariables = [\n    'interruptVectorCodeA',\n    'interruptVectorCodeB',\n    'interruptVectorCodeC',\n    'interruptVectorCodeOVF',\n    'interruptVectorCaptureCode'\n  ]\n  const interruptCommonSignature = useRecoilValue(\n    suggestedVariableAssignmentState('InterruptCommonSignature')\n  )\n  let code = interruptVariables\n    .map(\n      (variable) =>\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        useRecoilValue(suggestedVariableAssignmentState(variable)) || '//nocode'\n    )\n    .filter((value) => value !== '//nocode')\n\n  if (code.length && interruptCommonSignature) {\n    code = [\n      interruptCommonSignature + ' {',\n      ...code.map((code) => '    ' + code.split('\\n').join('\\n    ')),\n      '}'\n    ]\n  }\n  let str = code.join('\\n')\n  if (str.length) str += '\\n'\n  return <>{str}</>\n}\n\nconst CopyToClipboard = React.memo(\n  ({\n    codeContainerRef\n  }: {\n    codeContainerRef: React.RefObject<HTMLPreElement>\n  }) => {\n    // using refs to avoid rerenders\n    const [clicked, setClicked] = useState(false)\n    useEffect(() => {\n      setTimeout(() => setClicked(false), 600)\n    }, [clicked])\n    return (\n      <div>\n        <Button\n          color={clicked ? 'green' : undefined}\n          onClick={() => {\n            copy(codeContainerRef.current?.textContent || '')\n            setClicked(true)\n            console.log(codeContainerRef.current?.textContent || '')\n          }}\n        >\n          {clicked ? 'Copied' : 'Copy'}\n        </Button>\n      </div>\n    )\n  }\n)\n","import {\n  Checkbox,\n  CheckboxGroup,\n  FlexboxGrid,\n  Icon,\n  Panel,\n  Tooltip,\n  Whisper\n} from 'rsuite'\nimport { useRecoilValue, useSetRecoilState } from 'recoil'\nimport { variableDescriptions, valueDescriptions } from '../data/timers'\nimport { difference, map, uniq } from 'lodash'\nimport './TimerSetup.css'\n\nimport Plot from '../Plot/Plot'\nimport Code from './Code'\nimport ResizePanel from 'react-resize-panel-ts'\nimport { panelModeState, userConfigState } from '../state/state'\nimport { variableOptionsState, groupsState } from './state'\nimport { TTable, PanelModes } from '../helpers/types'\nconst VariableConfig = ({\n  variable,\n  humanName\n}: {\n  variable: string\n  humanName?: string\n}) => {\n  const setUserConfigValue = useSetRecoilState(userConfigState(variable))\n  const { selectedOption, forcedOption, options } = useRecoilValue(\n    variableOptionsState(variable)\n  )\n  const descr = valueDescriptions[variable]\n  const descrTitle = descr?.title\n  return (\n    <CheckboxGroup\n      inline\n      value={[selectedOption || forcedOption]}\n      onChange={(val: string[]) => setUserConfigValue(val[1])}\n    >\n      <p>\n        {humanName || variable}{' '}\n        {descrTitle && (\n          <Whisper\n            placement=\"right\"\n            trigger=\"hover\"\n            speaker={<Tooltip>{descrTitle}</Tooltip>}\n          >\n            <Icon\n              icon=\"info-circle\"\n              style={{ color: 'lightgrey', fontSize: 12 }}\n            />\n          </Whisper>\n        )}\n      </p>\n      {options.map(({ value, isSuggested, isDisabled }, i) => {\n        const valueDescription = descr?.[value]\n\n        return (\n          <span key={i}>\n            <Checkbox\n              indeterminate={isSuggested}\n              value={value}\n              disabled={isDisabled}\n            >\n              {value}\n            </Checkbox>{' '}\n            {valueDescription && (\n              <Whisper\n                placement=\"right\"\n                trigger=\"hover\"\n                speaker={<Tooltip>{valueDescription}</Tooltip>}\n              >\n                <Icon\n                  icon=\"info-circle\"\n                  style={{ color: 'lightgrey', fontSize: 12 }}\n                />\n              </Whisper>\n            )}\n          </span>\n        )\n      })}\n    </CheckboxGroup>\n  )\n}\n\ntype TPanel = {\n  panelName: string\n  namedVariables: {\n    variable: string\n    humanName?: string\n  }[]\n}\nconst getPanesByGroup = (groups: TTable[][]): TPanel[] =>\n  groups.map((group, i) => ({\n    panelName: `Group ${i}`,\n    namedVariables: group\n      .map((table) => Object.keys(table[0]))\n      .flat()\n      .map((variable) => ({ variable }))\n  }))\n\nconst getAllVariablesInGroups = (groups: TTable[][]) =>\n  uniq(\n    groups\n      .flat()\n      .map((table) => Object.keys(table[0]))\n      .flat()\n  )\nconst getPanesGroupedByDescription = (groups: TTable[][]): TPanel[] => {\n  const allVariablesInGroups = getAllVariablesInGroups(groups)\n  return map(variableDescriptions, (variableDescription, panelName) => ({\n    panelName,\n    namedVariables: map(variableDescription, (humanName, variable) => ({\n      variable,\n      humanName\n    })).filter(({ variable }) => allVariablesInGroups.includes(variable))\n  })).filter(({ namedVariables }) => namedVariables.length)\n}\nconst getHiddenPane = (groups: TTable[][]): TPanel => {\n  const allVariables = getAllVariablesInGroups(groups)\n\n  const visibleVariables: string[] = Object.values(variableDescriptions)\n    .map(Object.values)\n    .flat()\n  return {\n    panelName: 'Internals',\n    namedVariables: difference(allVariables, visibleVariables).map(\n      (variable) => ({\n        variable\n      })\n    )\n  }\n}\n\nfunction TimerSetup() {\n  const groups = useRecoilValue(groupsState)\n\n  const panelMode = useRecoilValue(panelModeState)\n  let panels: TPanel[]\n  switch (panelMode) {\n    case PanelModes.Normal:\n      panels = getPanesGroupedByDescription(groups)\n      break\n    case PanelModes.Internal:\n      panels = [getHiddenPane(groups), ...getPanesGroupedByDescription(groups)]\n      break\n    case PanelModes.ByDependencies:\n      panels = getPanesByGroup(groups)\n      break\n  }\n  const style = { width: 100 / (panels.length + 1) + '%' }\n\n  const r = (\n    <div className=\"TimerSetup\">\n      <FlexboxGrid style={{ flexGrow: 1, overflow: 'scroll' }}>\n        {panels.map(({ panelName, namedVariables }, i) => (\n          <FlexboxGrid.Item key={panelName} style={style}>\n            <Panel header={panelName} bordered shaded defaultExpanded>\n              {namedVariables.map(({ variable, humanName }, i) => (\n                <VariableConfig\n                  key={i}\n                  variable={variable}\n                  humanName={humanName}\n                />\n              ))}\n            </Panel>\n          </FlexboxGrid.Item>\n        ))}\n        <FlexboxGrid.Item key=\"code\" style={style}>\n          <Panel header=\"Code\" bordered shaded defaultExpanded>\n            <Code />\n          </Panel>\n        </FlexboxGrid.Item>\n      </FlexboxGrid>\n      <ResizePanel\n        direction=\"n\"\n        style={{\n          width: '100%',\n          bottom: 0,\n          flexGrow: 0,\n          borderTop: '1px solid lightgrey',\n          height: 200,\n          touchAction: 'none'\n        }}\n      >\n        <Plot style={{ minHeight: 300 }} />\n      </ResizePanel>\n    </div>\n  )\n  return r\n}\n\nexport default TimerSetup\n","import { map } from 'lodash'\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil'\nimport { Container, Content, Header, Icon, Nav, Navbar, Dropdown } from 'rsuite'\nimport 'rsuite/dist/styles/rsuite-default.css'\n\nimport './App.css'\nimport TimerSetup from './Panes/TimerSetup'\nimport { PanelModes, MicroControllers } from './helpers/types'\nimport {\n  panelModeState,\n  mcuTimers,\n  userConfigState,\n  userConfigStateBulk\n} from './state/state'\nconst gh = 'https://github.com/dbuezas/arduino-web-timers'\nconst App = () => {\n  const timerIdx = useRecoilValue(userConfigState('timer'))\n  const mcu = useRecoilValue(userConfigState('mcu'))\n  const setInBulk = useSetRecoilState(userConfigStateBulk)\n  const timers = useRecoilValue(mcuTimers)\n  const [panelMode, setPanelMode] = useRecoilState(panelModeState)\n  const isLoading = mcuTimers === undefined || timerIdx === undefined\n  return (\n    <>\n      <link\n        rel=\"stylesheet\"\n        href=\"https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css\"\n      />\n      <div>\n        {/* Rerender everything when the hash changes */}\n        {!isLoading && (\n          <Container className=\"App\">\n            <Header>\n              <Navbar appearance=\"inverse\">\n                <Navbar.Header>\n                  &nbsp;\n                  <span>\n                    <img\n                      src=\"./logo.png\"\n                      alt=\"logo\"\n                      style={{ width: 55.5, height: 55.5, float: 'left' }}\n                    />\n                    &nbsp;\n                    <span\n                      style={{\n                        float: 'left',\n                        marginTop: 7,\n                        textAlign: 'center'\n                      }}\n                    >\n                      ARDUINO WEB\n                      <br />\n                      TIMERS\n                    </span>\n                  </span>\n                </Navbar.Header>\n                <Navbar.Body>\n                  <Nav>\n                    <Dropdown\n                      trigger=\"click\"\n                      icon={<Icon icon=\"microchip\" />}\n                      title={mcu}\n                      placement=\"bottomEnd\"\n                    >\n                      {map(MicroControllers, (aChip) => (\n                        <Dropdown.Item\n                          // active={aChip === mcu}\n                          onSelect={(mcu) =>\n                            setInBulk({\n                              mcu,\n                              timer: '0'\n                            })\n                          }\n                          eventKey={aChip}\n                          key={aChip}\n                        >\n                          {aChip}\n                        </Dropdown.Item>\n                      ))}\n                    </Dropdown>\n                  </Nav>\n                  <Nav\n                    activeKey={timerIdx}\n                    onSelect={(timer) =>\n                      setInBulk({\n                        mcu,\n                        timer\n                      })\n                    }\n                  >\n                    {timers.map((_: any, i) => (\n                      <Nav.Item\n                        eventKey={'' + i}\n                        key={'' + i}\n                        icon={\n                          <>\n                            <Icon icon=\"line-chart\" />\n                          </>\n                        }\n                      >\n                        Timer {i}\n                      </Nav.Item>\n                    ))}\n                  </Nav>\n                  <Nav pullRight>\n                    <Dropdown\n                      trigger=\"click\"\n                      icon={<Icon icon=\"cog\" />}\n                      title={panelMode}\n                      placement=\"bottomEnd\"\n                    >\n                      {map(PanelModes, (mode) => (\n                        <Dropdown.Item\n                          // active={mode === panelMode}\n                          onSelect={setPanelMode}\n                          eventKey={mode}\n                          key={mode}\n                        >\n                          {mode}\n                        </Dropdown.Item>\n                      ))}\n                    </Dropdown>\n                    <Dropdown\n                      trigger=\"click\"\n                      icon={<Icon icon=\"help-o\" />}\n                      title=\"About\"\n                      placement=\"bottomEnd\"\n                    >\n                      <Dropdown.Item\n                        href={gh + '/discussions/categories/show-and-tell'}\n                        target=\"_blank\"\n                      >\n                        Share what you used this for!\n                      </Dropdown.Item>\n                      <Dropdown.Item\n                        href={gh + '/discussions/categories/q-a'}\n                        target=\"_blank\"\n                      >\n                        Q&A\n                      </Dropdown.Item>\n                      <Dropdown.Item\n                        href={gh + '/discussions/categories/ideas'}\n                        target=\"_blank\"\n                      >\n                        Propose a feature\n                      </Dropdown.Item>\n                      <Dropdown.Item\n                        href={gh + '/issues/new/choose'}\n                        target=\"_blank\"\n                      >\n                        Report a bug\n                      </Dropdown.Item>\n                    </Dropdown>\n                  </Nav>\n                  <iframe\n                    src=\"https://ghbtns.com/github-btn.html?user=dbuezas&repo=arduino-web-timers&type=star&count=true\"\n                    frameBorder=\"0\"\n                    scrolling=\"0\"\n                    width=\"100\"\n                    height=\"20\"\n                    title=\"GitHub\"\n                    style={{ marginTop: 18, float: 'right' }}\n                  ></iframe>\n                </Navbar.Body>\n              </Navbar>\n            </Header>\n            <Content\n              style={{\n                padding: 10,\n                // margin: 20,\n                background: '#fff',\n                position: 'relative'\n              }}\n            >\n              <TimerSetup key={timerIdx + '-' + mcu} />\n            </Content>\n          </Container>\n        )}\n      </div>\n      <a\n        className=\"github-fork-ribbon right-bottom fixed\"\n        href={gh}\n        data-ribbon=\"Fork me on GitHub\"\n        title=\"Fork me on GitHub\"\n      >\n        Fork me on GitHub\n      </a>\n    </>\n  )\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport { RecoilRoot } from 'recoil'\nimport { RegisterHashLink } from './state/state'\n\nReactDOM.render(\n  <React.StrictMode>\n    <RecoilRoot>\n      <RegisterHashLink />\n\n      <App />\n    </RecoilRoot>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}